/*------------------------------------------------------------------------------*
  #FLEX-GRID - START
\*------------------------------------------------------------------------------*/

////
/// Responsive Flex based Grid for easy OOCSS development
///
/// @group flex-grid
////

/// Number of colums for the grid-classes
$columns: 12 !default;

/// Space between columns as padding inside the grid-columns - 15px on each side
$gutter: 30px !default;

/// Container width for screens over 990px wide.
$container: 960px !default;

/// Activate/deactivate responsive classes
$responsive: true !default;

$responsive-breakpoints: null;

$grid-container-prefix: container;
$grid-row-prefix: row;
$grid-row-utility-prefix: pos;
$grid-item-prefix: item;
$grid-offset-prefix: offset;

@if (not $responsive) {
  $responsive-breakpoints: (
          sm: 0
  );
}

/// Breakpoints for responsive design - no prefix = mobile, sm = pads, md = larger screens
$responsive-breakpoints: (
        sm: 0,
        md: 576px,
        lg: 992px
) !default;

/// Settings to remove the smallest responsive size suffix
$remove-base-suffix: true !default;

/// Activate/Deactivate grid prefix for all grid glasses.
$grid-prefix: true !default;

/// Specify the prefix for the grid
$grid-prefix-type: g;

/// Base requirements - Box Sizing
html {
  box-sizing: border-box;
}

/// Base requirements - Box Sizing - all inherit
*,
*::before,
*::after {
  box-sizing: inherit;
}

/// Mixin for mobile first development - @media (min-width: $responsive breakpoint)
/// @param screen-size
@mixin screen-size($size) {
  @if (map_get($responsive-breakpoints, $size) == 0 or $size == 0) {
    @content
  } @else if (map-get($responsive-breakpoints, $size)) {
    @media (min-width: map-get($responsive-breakpoints, $size)) {
      @content;
    }
  } @else if (type_of($size) == 'number') {
    @media (min-width: $size) {
      @content;
    }
  }
}

@mixin prefix-suffix-constructor($class, $size: "", $args...) {
  @if ($size != "") {
    @if (map_get($responsive-breakpoints, $size) == 0 and $remove-base-suffix and $grid-prefix) {
      .#{$grid-prefix-type}-#{$class}#{$args} {
        @content
      }
    } @else if (map_get($responsive-breakpoints, $size) == 0 and $remove-base-suffix and not $grid-prefix) {
      .#{$class}#{$args} {
        @content
      }
    } @else if (map_get($responsive-breakpoints, $size) == 0 and not $remove-base-suffix and $grid-prefix) {
      .#{$grid-prefix-type}-#{$class}-#{$size}#{$args} {
        @content
      }
    } @else if (map_get($responsive-breakpoints, $size) == 0 and not $remove-base-suffix and not $grid-prefix) {
      .#{$class}-#{$size}#{$args} {
        @content
      }
    } @else if (map_get($responsive-breakpoints, $size) != 0 and $grid-prefix) {
      .#{$grid-prefix-type}-#{$class}-#{$size}#{$args} {
        @content
      }
    } @else if (map_get($responsive-breakpoints, $size) != 0 and not $grid-prefix) {
      .#{$class}-#{$size}#{$args} {
        @content
      }
    }
  } @else if ($grid-prefix) {
    .#{$grid-prefix-type}-#{$class}#{$args} {
      @content
    }
  } @else {
    .#{$class}#{$args} {
      @content
    }
  }
}

$row-utilities: (
        xy-center: (justify-content: center, align-items: center),
        x-fs: (justify-content: flex-start),
        x-fe: (justify-content: flex-end),
        x-center: (justify-content: center),
        x-sa: (justify-content: space-around),
        x-sb: (justify-content: space-between),
        y-fs: (align-items: flex-start),
        y-fe: (align-items: flex-end),
        y-center: (align-items: center),
        y-bl: (align-items: baseline),
        y-st: (align-items: stretch)
);

@mixin row-utilities($class, $size) {
  @each $utility-class, $sub-map in $row-utilities {
    @include prefix-suffix-constructor(#{$class}, $size, -#{$utility-class}) {
      @each $property, $value in $sub-map {
        #{$property}: $value;
      }
    }
  }
}

$item-utilities: (
        fs: (align-self: flex-start),
        fe: (align-self: flex-end),
        center: (align-self: center),
        bl: (align-self: baseline),
        st: (align-self: stretch),
);

@mixin item-utilities($class, $size) {
  @each $utility-class, $sub-map in $item-utilities {
    @include prefix-suffix-constructor(#{$class}, $size, -#{$utility-class}) {
      @each $property, $value in $sub-map {
        #{$property}: $value;
      }
    }
  }
}

/*-------------------------------------*
  #Grid Container
\*-------------------------------------*/

%grid-container {
  margin-left: auto;
  margin-right: auto;
  width: $container;
  max-width: 100%;
  position: relative;
  padding-left: 15px;
  padding-right: 15px;
}

/// Fixed-width container
@include prefix-suffix-constructor($grid-container-prefix) {
  @extend %grid-container;
}

/*-------------------------------------*
  #Grid Row Classes
\*-------------------------------------*/
%grid-row {
  position: relative;
  flex-flow: row wrap;
  margin-left: -($gutter / 2);
  margin-right: -($gutter / 2);
}

@each $size, $value in $responsive-breakpoints {
  @include prefix-suffix-constructor($grid-row-prefix, #{$size}) {
    @extend %grid-row;
    @include screen-size($size) {
      display: flex;
    }
  }
}

/*-------------------------------------*
  #Grid Row Utility Classes
\*-------------------------------------*/
@include prefix-suffix-constructor(no-padding) {
  margin-left: 0;
  margin-right: 0;
  > [class~=item] {
    padding-left: 0;
    padding-right: 0;
  }
}

@include prefix-suffix-constructor(add-padding) {
  padding-right: ($gutter / 2);
  padding-left: ($gutter / 2);
}

@each $size, $value in $responsive-breakpoints {
  @include screen-size($size) {
    @include row-utilities($grid-row-utility-prefix, $size)
  }
}

/*-------------------------------------*
  #Grid Items
\*-------------------------------------*/

%grid-item {
  position: relative;
  min-height: 1px;
  padding-right: ($gutter / 2);
  padding-left: ($gutter / 2);
  flex: 0 0 100%;
}

@each $size, $value in $responsive-breakpoints {
  @include prefix-suffix-constructor($grid-item-prefix, $size) {
    @extend %grid-item;
    @include screen-size($size) {
      flex: 1;
    }
  }
}

@each $size, $value in $responsive-breakpoints {
  @for $i from 1 through $columns {
    @include prefix-suffix-constructor($grid-item-prefix, $size, -#{$i}) {
      @extend %grid-item;
    }
  }
}

@each $size, $value in $responsive-breakpoints {
  @include screen-size($size) {
    @for $i from 1 through $columns {
      @include prefix-suffix-constructor($grid-item-prefix, $size, -#{$i}) {
        flex: 0 0 percentage($i / $columns);
      }
    }
  }
}

/*-------------------------------------*
  #Grid Item Utility Classes
\*-------------------------------------*/
@each $size, $value in $responsive-breakpoints {
  @include screen-size($size) {
    @include item-utilities($grid-item-prefix, $size)
  }
}

@each $size, $value in $responsive-breakpoints {
  @include screen-size($size) {
    @for $i from 1 through $columns {
      @include prefix-suffix-constructor($grid-offset-prefix, $size, -#{$i}) {
        margin-left: percentage($i / $columns)
      }
    }
  }
}
